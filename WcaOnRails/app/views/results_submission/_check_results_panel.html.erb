<%
  # NOTE: expect valid 'results_validator' variable
  panel_style = if results_validator.total_errors > 0
                  "danger"
                elsif results_validator.total_warnings > 0
                  "warning"
                else
                  "success"
                end
%>
<div class="panel panel-<%= panel_style %>">
  <div class="panel-heading heading-as-link <%= "collapsed" unless results_validator.has_results %>" data-toggle="collapse" data-target="#collapse-check-results">
    <h3 class="panel-title">
      <% if results_validator.check_real_results %>
        Check competition's results
      <% else %>
        Check imported results
      <% end %>
      <span class="collapse-indicator"></span>
    </h3>
  </div>
  <div id="collapse-check-results" class="panel-body collapse <%= "in" if results_validator.has_results %>">
    <h3>Errors</h3>
    <% if results_validator.total_errors > 0 %>
      <p>Please fix the errors below:</p>
      <% results_validator.errors.each do |type, errors| %>
        <% if errors.any? %>
          <h4>Errors detected in <%= type %></h4>
          <ul>
            <% errors.each do |error| %>
              <li><%= error %></li>
            <% end %>
          </ul>
        <% end %>
      <% end %>
    <% elsif !results_validator.has_results %>
      <p class="text-danger">
        <% if results_validator.check_real_results %>
          No results for the competition yet.
        <% else %>
          No results submitted yet.
        <% end %>
      </p>
    <% else %>
      <p>No error detected in the results.</p>
    <% end %>
    <h3>Warnings</h3>
    <% if results_validator.total_warnings > 0 %>
      <p>
        Please pay attention to the warnings below.
        <% unless results_validator.check_real_results %>
          You may need to add a comment about them when submitting these results to the WRT!
        <% end %>
      </p>
      <% results_validator.warnings.each do |type, warnings| %>
        <% if warnings.any? %>
          <h4>Warnings detected in <%= type %></h4>
          <ul>
            <% warnings.each do |warning| %>
              <li><%= warning %></li>
            <% end %>
          </ul>
        <% end %>
      <% end %>
    <% elsif !results_validator.has_results %>
      <p class="text-danger">
        <% if results_validator.check_real_results %>
          No results for the competition yet.
        <% else %>
          No results submitted yet.
        <% end %>
      </p>
    <% else %>
      <p>No warning detected in the results.</p>
    <% end %>
  </div>
</div>
